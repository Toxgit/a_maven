//USEUNIT MainMenu
//USEUNIT OpenStrHelper
//USEUNIT Settings
//USEUNIT VariablesHelper
//USEUNIT WindowHelper

//данный тест проверяет сортировку списка переменных и Maximize окна 
function Variables_sort()
{
  var testStrategyPath =  strLocation + "Main dialog area.strat";//путь к стратегии для теста
  var menu = new MainMenuControl();
  var variables = new Variables.Variables();
  
  Log.Message("Проверка сортировки переменных.");
  openStrByPath(testStrategyPath);
  menu.toVariables();
  maximizeWin(variables);//maximizeWin
  restoreWin(variables);//restoreWin
  sortListByHeader(variables,"Name");
  verifySortOnlyForThisTest("VarDateCol",3);
  sortListByHeader(variables,"Name");
  verifySortOnlyForThisTest("VarDateCol",7);
  sortListByHeader(variables,"Type");
  verifySortOnlyForThisTest("VarDateCol",9);
  sortListByHeader(variables,"Type");
  verifySortOnlyForThisTest("VarDateCol",1);
  sortListByHeader(variables,"Direction");
  verifySortOnlyForThisTest("VarDateCol",6);
  sortListByHeader(variables,"Direction");
  verifySortOnlyForThisTest("VarDateCol",4);
  sortListByHeader(variables,"Linked");
  verifySortOnlyForThisTest("VarDateCol",3);
  sortListByHeader(variables,"Linked");
  verifySortOnlyForThisTest("VarDateCol",7);
  variables.ok();
  closeOneStr();
}

function verifySortOnlyForThisTest(variable,position) //проверка проходит по индексу переменной в конкретной стратегии
{
   if ( listFindVar(variable) == position) Log.Checkpoint("Отсортировано правильно");
   else Log.Warning("Отсортировано неправильно("+variable+" не на "+position+" месте)");
}
