//USEUNIT Settings
//USEUNIT MainMenu
//USEUNIT Variables
//USEUNIT VariablesHelper
//USEUNIT OpenStrHelper
//ГЫУГТШЕ WindowHelper

//данный тест проверяет сортировку списка переменных и Maximize окна 
function Name_notempty_sort()
{
  var testStrategyPath =  strLocation + "Main dialog area.strat";//путь к стратегии для теста
  var menu = new MainMenuControl();
  var variables = new Variables.Variables();
  
  Log.Message("Проверка сортировки переменных.");
  openStrByPath(testStrategyPath);
  menu.toVariables();
  maximizeWin(variables);
  restoreWin(variables);
  sortListByHeader("Name");
  verifySortOnlyForThisTest("VarDateCol",3);
  sortListByHeader("Name");
  verifySortOnlyForThisTest("VarDateCol",7);
  sortListByHeader("Type");
  verifySortOnlyForThisTest("VarDateCol",9);
  sortListByHeader("Type");
  verifySortOnlyForThisTest("VarDateCol",1);
  sortListByHeader("Direction");
  verifySortOnlyForThisTest("VarDateCol",6);
  sortListByHeader("Direction");
  verifySortOnlyForThisTest("VarDateCol",4);
  sortListByHeader("Linked");
  verifySortOnlyForThisTest("VarDateCol",3);
  sortListByHeader("Linked");
  verifySortOnlyForThisTest("VarDateCol",7);
  variables.ok();
  closeOneStr();
}

function verifySortOnlyForThisTest(variable,position) //проверка проходит по индексу переменной в конкретной стратегии
{
   if ( listFindVar(variable) == position) Log.Checkpoint("Отсортировано правильно");
   else Log.Warning("Отсортировано неправильно("+variable+" не на "+position+" месте)");
}
